html
Copy
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Interactive Land Plots - Cesium</title>
<script src="https://cesium.com/downloads/cesiumjs/releases/1.118/Build/Cesium/Cesium.js"></script>
<link href="https://cesium.com/downloads/cesiumjs/releases/1.118/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
<style>
/* ?????: ?? ????? CSS ????? ????? */
html, body, #cesiumContainer {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
}

#infoBox {
    position: absolute;
    top: 10px;
    left: 10px;
    background: rgba(42, 42, 42, 0.8); /* ????? ????? ????? */
    color: white;
    padding: 15px;
    border-radius: 8px;
    z-index: 1; /* ?????? ?? ????? ??? ??????? */
    display: none; /* ?????? ?? ??????? */
    max-width: 300px;
    font-family: Arial, sans-serif;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

#infoBox h3 {
    margin-top: 0;
    color: #4CAF50; /* ??? ???? ??????? */
    border-bottom: 1px solid #4CAF50;
    padding-bottom: 5px;
    margin-bottom: 10px;
}

#infoBox p {
    margin-bottom: 8px;
    line-height: 1.4;
}

#infoBox strong {
    color: #ADD8E6; /* ??? ???? ?????? ?????? */
}

#infoBox button {
    background-color: #f44336; /* ?? ????? ???? */
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 10px;
    float: right; /* ???? ???? ?? ??????? */
}

#infoBox button:hover {
    background-color: #d32f2f;
}
</style>
</head>
<body>
<div id="cesiumContainer"></div>
<div id="infoBox">
    <h3>?????? ???? ?????</h3>
    <p><strong>???? ??????:</strong> <span id="plotId"></span></p>
    <p><strong>??????:</strong> <span id="plotStatus"></span></p>
    <p><strong>???????:</strong> <span id="plotArea"></span> ??? ????</p>
    <p><strong>?????:</strong> <span id="plotPrice"></span></p>
    <p><a id="plotDetailsLink" href="#" target="_blank" style="color: #64B5F6; text-decoration: none;">???? ?? ???????? &raquo;</a></p>
    <button onclick="document.getElementById('infoBox').style.display = 'none'">?????</button>
</div>

<script>
// ???? Cesium Ion ????? ?? - ?? ?????? ????? ??? ?? ?????
Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyNWE2ZjBlZC1mM2NiLTRkYmYtODYzYS02Y2IwNzc4YmQ4Y2IiLCJpZCI6MzU1MzM3LCJpYXQiOjE3NjQwMjE5MzJ9.cHOUlWAXZAsqXniZI_qyNj9J54TEczS0nqOvb1mbSNwe
';

// ????? ???????
const viewer = new Cesium.Viewer("cesiumContainer", {
    terrain: Cesium.Terrain.fromWorldTerrain(), // ?????? ??????
    animation: false,
    timeline: false,
    baseLayerPicker: true,
    fullscreenButton: true,
    geocoder: false, // ????? ???? ????? ????????? ??? ?? ??? ????? ????
    homeButton: true,
    navigationHelpButton: false,
    infoBox: false // ????? ????? ????????? ????????? ?? Cesium
});

// ???? ?????? ??? ??????? ?? ??? KML
async function loadLandPlots(dataSourcePath) {
    try {
        // ??????? Cesium.KmlDataSource.load ?????? ??? KML
        const kmlDataSource = await Cesium.KmlDataSource.load(dataSourcePath, {
            camera: viewer.scene.camera,
            canvas: viewer.scene.canvas,
            clampToGround: true // ???? ???????? ????? ?????????
        });

        await viewer.dataSources.add(kmlDataSource);
        await viewer.zoomTo(kmlDataSource);
        console.log(`?? ????? ${kmlDataSource.entities.values.length} ???? ??? ?? ??? KML.`);

        // ????? ???? ??? ??????? ??? ???????
        kmlDataSource.entities.values.forEach(entity => {
            if (Cesium.defined(entity.polygon)) {
                // ?????? ??? ??????? ?? ExtendedData ?? KML? ?????? entity.properties.propertyName
                const statusProperty = entity.properties && entity.properties.status;
                const status = statusProperty && statusProperty.getValue(); // ?????? ?? ?????? ??? getValue()

                if (status === '????') {
                     entity.polygon.material = Cesium.Color.RED.withAlpha(0.4);
                     entity.polygon.outlineColor = Cesium.Color.RED.withAlpha(0.7);
                } else {
                    entity.polygon.material = Cesium.Color.fromCssColorString('#4CAF50').withAlpha(0.4);
                    entity.polygon.outlineColor = Cesium.Color.BLACK.withAlpha(0.7);
                }
                entity.polygon.outlineWidth = 3;
            }
        });

    } catch (error) {
        console.error('??? ??? ????? ????? ??? ??????? ?? KML:', error);
        alert('??? ??? ????? ????? ??? KML. ???? ?????? ?? ?????? ????????.');
    }
}

// ??????? ???? ???????
// ???? ?? ?? ??? ????? ??? ?????? ?????? ?? ??? ??? KML ????? ??.
// ??? ??? ??? KML ????? ?? ???? ????? "my_plots.kml" ???? ????? ???: loadLandPlots('./my_plots.kml');
loadLandPlots('./plots.kml');

// ????? ????? ?????
const handler = new Cesium.ScreenSpaceEventHandler(viewer.scene.canvas);
handler.setInputAction(function(click) {
    const pickedObject = viewer.scene.pick(click.position);
    const infoBox = document.getElementById('infoBox');

    // ????? ????? ????????? ?????
    infoBox.style.display = 'none';
    viewer.selectedEntity = undefined; // ????? ????? ?? ???? ????

    if (Cesium.defined(pickedObject) && Cesium.defined(pickedObject.id)) {
        // ?? ????? ??? ???? (entity)
        const clickedPlot = pickedObject.id;

        // ?? KML? ??? ?????? ??? ??????? ??? entity.properties.propertyName.getValue()
        const properties = clickedPlot.properties;

        // ????? ???? ??????? ??? ?????? ?????? ?????
        if (Cesium.defined(properties)) {
            // ????? ????? ????? ?????????? ?? ?????? ?? ???? ?? ?????
            document.getElementById('plotId').textContent = properties.id ? properties.id.getValue() : '??? ?????';
            document.getElementById('plotStatus').textContent = properties.status ? properties.status.getValue() : '??? ?????';
            document.getElementById('plotArea').textContent = properties.area ? properties.area.getValue() : '??? ?????';
            document.getElementById('plotPrice').textContent = properties.price ? properties.price.getValue() : '??? ?????';

            const detailsLink = document.getElementById('plotDetailsLink');
            if (properties.details_url && properties.details_url.getValue()) {
                detailsLink.href = properties.details_url.getValue();
                detailsLink.style.display = 'inline';
            } else {
                detailsLink.style.display = 'none';
            }

            // ????? ????? ?????????
            infoBox.style.display = 'block';

            // ???????: ????? ????? ??? ?????? ????????
            viewer.selectedEntity = clickedPlot;
        }
    }
}, Cesium.ScreenSpaceEventType.LEFT_CLICK);

// ????? ????? ????????? ??? ????? ???? ?? ???? ??? ?? ??? ????? ???????
handler.setInputAction(function() {
    document.getElementById('infoBox').style.display = 'none';
    viewer.selectedEntity = undefined;
}, Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK); // ???? ??????? Double Click ?? ????? Logic ??? ???? ?????? ?? Left Click ????

viewer.camera.changed.addEventListener(function() {
    document.getElementById('infoBox').style.display = 'none';
    viewer.selectedEntity = undefined;
});

</script>
</body>
</html>
